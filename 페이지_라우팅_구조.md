# 페이지 라우팅 구조

> 기준 코드: `frontend/src/App.tsx` (main 브랜치)
> 라우팅 방식: React Router 미사용, `view` + `activeTab` 상태 기반
> 최종 업데이트: 2026-02-18

---

## 1) 최상위 View 라우팅

| view 값 | 컴포넌트 | 진입 조건 | 종료/이동 |
|---|---|---|---|
| `login` | `<Login>` | 토큰 없음 | `welcome`, `signup` |
| `signup` | `<Signup>` | 로그인 화면에서 회원가입 클릭 | `login`, `welcome` |
| `welcome` | `<WelcomePage>` | 로그인/회원가입 성공 | `dashboard` |
| `dashboard` | 탭 영역 | 토큰 존재 시 기본 진입 | `profile`, `data-input`, `reports`, `analytics` |
| `profile` | `<Profile>` | 헤더 프로필 메뉴 | `dashboard` |
| `data-input` | `<DataInput>` | 헤더 메뉴 | `dashboard` |
| `reports` | `<Reports>` | 헤더 메뉴 | `dashboard` |
| `analytics` | `<Analytics>` | 헤더 메뉴 | `dashboard` |

---

## 2) Dashboard 내부 탭 라우팅

> `view === 'dashboard'`일 때 `activeTab`으로 분기

| activeTab | 컴포넌트 | 설명 |
|---|---|---|
| `dashboard` | `<DashboardTab>` | KPI 카드 + 배출 추이 |
| `compare` | `<CompareTab>` | 경쟁사 비교 |
| `simulator` | `<SimulatorTab>` | ETS 시뮬레이션 |
| `target` | `<TargetTab>` | SBTi 목표/확률 분석 |

현재 탭 정의:

```ts
const tabs = [
  { id: 'dashboard' as TabType, label: 'Dashboard' },
  { id: 'compare' as TabType, label: 'Compare' },
  { id: 'simulator' as TabType, label: 'ETS Simulator' },
  { id: 'target' as TabType, label: 'Targets' },
];
```

참고:
- `investment` 탭은 제거됨.
- `TabType`도 `'dashboard' | 'compare' | 'simulator' | 'target'`만 사용.

---

## 3) 상태 저장 및 브라우저 히스토리

- `localStorage`
  - `view`
  - `activeTab`
- `window.history.pushState`
  - `navigateTo(view, tab)` 호출 시 URL query(`?view=...&tab=...`) 기록
- `popstate`
  - 브라우저 뒤로가기/앞으로가기 시 `view`, `activeTab` 복원

핵심 함수:

```ts
const navigateTo = useCallback((newView: ViewType, newTab: TabType = activeTab) => {
  setView(newView);
  setActiveTab(newTab);
  window.history.pushState({ view: newView, activeTab: newTab }, '', `?view=${newView}&tab=${newTab}`);
}, [activeTab]);
```

---

## 4) 헤더/프로필 메뉴 동작

- 헤더 탭 클릭: `setActiveTab={(tab) => navigateTo('dashboard', tab)}`
- 로고 클릭: `navigateTo('dashboard', 'dashboard')`
- 프로필 설정: `navigateTo('profile')`
- 로그아웃: 토큰 제거 후 `view='login'`

프로필 드롭다운 shortcut:
- Dashboard
- Compare
- Simulator
- Targets
- Profile Settings
- Sign Out

---

## 5) 채팅 UI

- `<ChatBot>` 컴포넌트는 로그인 이후 레이아웃 하단에서 항상 마운트됨
- `isChatOpen`, `chatMessages`, `inputMessage` 상태를 `App.tsx`에서 관리
